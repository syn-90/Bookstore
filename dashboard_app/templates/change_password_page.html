{% extends '_layout.html' %}

{% block title %}
    تغییر رمز عبور
{% endblock %}

{% block content %}
    <!-- Dashboard area -->
    <section class="bj_account_dashboard" data-bg-color="#f5f5f5">
        <div class="container rtl">
            <div class="row">
                <div class="col-lg-3">
                    <div class="account_dashboard_sidebar">
                        <div class="sidebar_widget_body d-flex account_dashboard_sidebar_profile">
                            <div class="">
                                <img src="{{ user.avatar.url }}" alt="account" class="rounded-circle" style="width: 80px; height: 80px; object-fit: cover;">
                            </div>
                            <div class="ms-3">
                                <div class="greetings">درود</div>
                                <div class="name fw-bold">{{ user.username }}</div>
                            </div>
                        </div>
                        <div class="sidebar_widget_body p-0">
                                <ul class="sidebar_widget_menu">

                                    <li><a  href="{% url 'dashboard_page' %}">پروفایل من</a></li>
                                    <li><a class="active " href="{% url 'change_password' %}">تغییر رمز عبور</a></li>
                                    <li><a href="my-address.html">آدرس من</a></li>
                                    <li><a href="my-orders.html">سفارشات من</a></li>
                                    <li><a href="my-ebook-library.html">کتاب خانه الکتورنیکی من </a></li>
                                    <li><a href="my-list.html">لیست های من</a></li>
                                    <li><a href="my-wishlist.html">علاقه مندی های من</a></li>
                                    <li><a href="my-rating-reviews.html">رتبه بندی و نظرات من</a></li>
                                    <li><a href="my-following-authors.html">نویسندگان بعدی من</a></li>
                                </ul>
                            </div>
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="account_dashboard_body">
                        <div class="account_dashboard_content">
                            <div class="account_dashboard_content_header">
                                تغییر رمز عبور
                            </div>
                            <div class="content_body">
                                <form method="post">
                                    {% csrf_token %}

                                    {% if form.errors %}
                                        <div class="alert alert-danger">
                                            لطفاً خطاهای زیر را اصلاح کنید:
                                            <ul>
                                                {% for field, errors in form.errors.items %}
                                                    {% for error in errors %}
                                                        <li>{{ error }}</li>
                                                    {% endfor %}
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}

                                    <div class="row gy-3">
                                        <div class="col-lg-12">
                                            <div class="form-group pass-field-with-icon">
                                                <label class="form-label">رمز عبور فعلی</label>
                                                <input type="password" name="old_password" class="form-control" required>
                                                <i data-toggleTarget="#id_old_password"
                                                   class="icon fas fa-eye toggle-password"></i>
                                            </div>
                                        </div>

                                        <div class="col-lg-6">
                                            <div class="form-group pass-field-with-icon">
                                                <label class="form-label">رمز عبور جدید</label>
                                                <input type="password" name="new_password1" class="form-control" required>
                                                <i data-toggletarget="#toggle_passowrd_field" class="icon fas fa-eye toggle-password"></i>
                                                <small class="form-text text-muted">
                                                    رمز عبور باید حداقل 8 کاراکتر داشته باشد.
                                                </small>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="form-group pass-field-with-icon">
                                                <label class="form-label">تکرار رمز عبور جدید</label>
                                                <input type="password" name="new_password2" class="form-control" required>
                                                <i data-toggleTarget="#id_new_password2"
                                                   class="icon fas fa-eye toggle-password"></i>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-4">
                                        <button type="submit" class="bj_theme_btn">تغییر رمز عبور</button>
{#                                        <a href="{% url 'profile' %}" class="bj_theme_btn strock_btn ms-2">انصراف</a>#}
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // فعال کردن نمایش/مخفی کردن رمز عبور
        document.querySelectorAll('.toggle-password').forEach(function(icon) {
            icon.addEventListener('click', function() {
                const target = document.querySelector(this.getAttribute('data-toggleTarget'));
                if (target.type === 'password') {
                    target.type = 'text';
                    this.classList.remove('fa-eye');
                    this.classList.add('fa-eye-slash');
                } else {
                    target.type = 'password';
                    this.classList.remove('fa-eye-slash');
                    this.classList.add('fa-eye');
                }
            });
        });
    </script>
{% endblock %}</title>
</head>
<body>

</body>
</html>